#!/bin/bash
# Void Linux post-install script

echo "$(tput setaf 1)						Starting Void Linux post-install script$(tput sgr 0)"

# Install packages
sudo xbps-install -Su
sudo xbps-install -S $(cat INSTALL/1_repos)
sudo xbps-install -S $(cat INSTALL/2_base)

# Choose gpu
echo "$(tput setaf 1)						Which GPU you using?$(tput sgr 0)"
read -p "NVIDIA (n) or AMD (a) or QEMU (q)[n/a/q] " -n 1 video
echo
    if [[ $video = "n" ]]; then
        sudo xbps-install -S $(cat INSTALL/3_nvidia)
    elif [[ $video = "q" ]]; then
        sudo xbps-install -S $(cat INSTALL/3_qemu)
    elif [[ $video = "a" ]]; then
        sudo xbps-install -S $(cat INSTALL/3_ati)
    else
    echo "Invalid option."
    exit 1
fi

#sudo xbps-install -S $(cat INSTALL/3_nvidia)
sudo xbps-install -S $(cat INSTALL/4_desktop)
sudo xbps-install -S $(cat INSTALL/5_openbox)
#sudo xbps-install -S $(cat INSTALL/6_media)
#sudo xbps-install -S $(cat INSTALL/7_virtual)
#sudo xbps-install -S $(cat INSTALL/8_big)
#sudo xbps-install -S $(cat INSTALL/)
#sudo xbps-install -S $(cat INSTALL/)

# nested virtualization AMD
#modprobe kvm-amd

# make fish base shell
sudo usermod --shell /bin/fish zen
echo alias xterm 'sakura' > ~/.config/fish/aliases.fish

# čeština
sudo nano /etc/default/libc-locales
sudo xbps-reconfigure -f glibc-locales


# creating bare repository
cd ~/
mkdir .void
cd .void
git init --bare

# Install services

sudo ln -s /etc/sv/dbus /var/service
#sudo ln -s /etc/sv/lightdm /var/service
sudo ln -s /etc/sv/acpid /var/service
#sudo ln -s /etc/sv/dbus /var/service
#sudo ln -s /etc/sv/dbus /var/service
